# Routes & Resources Review
## Learning Goals
- Revist RESTful routing in Rails
- Learn about using the Rails `resources` route helpers

## Route Order
Rails routes are matched in the order they are specified. This can present a problem when a wildcard is used.

```ruby
get "/products/:id", to: "products#show"
get "/products/new", to: "products#new"
```

When Rails receives a request to `products/new` in this example, it will match the first route. Both of the routes above match `/products/new`! Rails doesn't know what `:id` means; it's not looking for an integer. It's looking for anything--including the word `new`--that matches the route. `products/new` in this case will route to the `ProductController#show` action. For the desired routes reorder the declarations:

```ruby
get "/products/new", to: "products#new"
get "/products/:id", to: "products#show"
```

That general rule is that routes go from most to least specific for any given resource.

## REST
Representational state transfer (REST) is an architectual style. This is a recommendation for the structure and style in which a resource (typically represented by a Model) can be represetned and managed through a web server.

The core of this idea can be described through routing. For example, let's look at how to represent a `Market` resource:

|PATH        | METHOD| DESCRIPTION|
|:----------|:-----:|:-----------|
| /markets       | GET    | Retrieves a collection of market objects|
| /markets       | POST   | Creates a market object on the server. |
| /markets/:id   | GET    | Retrieves an  individual market object through an identifying attribute, given in the url path.|
| /markets/:id   | PATCH    | Updates an individual market object through an identifying attribute, given in the url path.|
| /markets/:id   | PUT    | Updates an individual market object through an identifying attribute, given in the url path.|
| /markets/:id   | DELETE | Removes an individual market object through an identifying attribute, given in the url path.|

You can see that many actions can be performed on a market object using only two paths.
The paths represent the scope of the objects to operate on and the HTTP method indicates what type of action should be performed.

## Named Routes for REST
Since the standard RESTful resource only requires two paths, all five actions can be represented by just the two named routes.

The conventional route names for this RESTful resource would be `markets_path` and `market_path`. We use the plural version when referring to a _collection_ of Market objects (`index` action), and the singular version when refrring to an _instance_ or _specific_ Market (`show`, `edit`, etc).

Here's an example:

```erb
<% @markets.each do |market| %>
  <%= link_to "Market Details", market_path(market) %>
<% end %>
```

## Resources
Rails has several _route helpers_ available. The most commons is the `resources` method which generates the default RESTful routes for the names resource:

```ruby
Rails.application.routes.draw do
  resources :albums
end
```

This is equivalent to:

```ruby
Rails.application.routes.draw do
  get    "/albums"          , to: "albums#index",   as: :albums
  post   "/albums"          , to: "albums#create"
  get    "/albums/:id"      , to: "albums#show",    as: :album
  patch  "/albums/:id"      , to: "albums#update"
  put    "/albums/:id"      , to: "albums#update"
  delete "/albums/:id"      , to: "albums#destroy"
  get    "/albums/new"      , to: "albums#new",     as: :new_album
  get    "/albums/:id/edit" , to: "albums#edit",    as: :edit_album
end
```

### Don't get lazy with `resources`
Only ever use `resources` if you intend on implementing the full suite of RESTful routes for the resource. It's much more typical to only use a few of the routes generated by `resources`. For example, if a resource is meant to be read-only, we wouldn't need the `edit`, `create`, or `delete` routes.

To account for this, the `resources` route helper accepts options to limit the routes generated:

```ruby
Rails.application.routes.draw do
  # only generate the specified routes
  resources :albums, only: [:index, :show]

  # generates every RESTful route _except_ for POST (create) and DELETE (destroy)
  resources :artists, except: [:create, :destroy]
end
```
